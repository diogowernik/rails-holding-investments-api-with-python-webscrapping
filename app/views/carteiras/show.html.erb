<%= render partial: "carteiras/navbar" %>

<div class="float-right"><%= link_to new_investimento_path do %>
	<button class="btn btn-outline-success">
		<em class="fa fa-plus-circle"></em> &nbsp; Novo Investimento
	</button><% end %>
</div>

<h3 class="h3-custom mb-4" id="minhas-paginas">
	Mov. de Derivativos
</h3>



<h3 class="h4 mt-3" id="minhas-paginas">
	Ações
</h3>

<div class="row">
    <div class="col-md-4 mt-4">
        <div class="card">
               <div class="card-body">
                   <h4 class="m-0">Alguma Info aqui
                   
                   </h4>
               </div>
               <div class="card-body">
                  
               </div>
        </div>
        
    </div>
    <div class="col-md-8 mt-4">
        <% @vencimentos.order("created_at desc").each do |vencimento| %>
            <% if @deriva_moves.where(:vencimento_id => vencimento.id).sum(:resultado) != 0 %>
            <div class="card">
                   <div class="card-body">
                       <h4 class="m-0"><%= vencimento.data.strftime("%m / %Y") %>
                           <small class="text-primary float-right mr-1">
                               <b>
                                   <%= number_to_currency(@deriva_moves.where(:vencimento_id => vencimento.id).sum(:resultado), unit: "R$ ", separator: ",", delimiter: ".", strip_insignificant_zeros: true) %>
                                </b>
                           </small> 
                           <small class="text-muted float-right">Resultado:</small>
                       </h4>
                   </div>
                   
                   <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered table-hover" id="DerivaMoveTable">
                                  <thead>
                                    <tr class="header">
                                      <!--<th>Invest</th>-->
                                      <th> Derivativo</th>
                                      <th>Status </th>
                                      <th>Corretora</th>
                                      <th>Tipo</th>
                                      <th>Quant</th>
                                      <th>Resultado</th>
                                      <th colspan="2"></th>
                                    </tr>
                                  </thead>
                                
                                  <tbody>
                                    <% @deriva_moves.order("created_at desc").where(:carteira_id => @carteira.id).where(:vencimento_id => vencimento.id).each do |dm| %>
                                    <tr>
                                        <td><%= dm.codigo %></td>
                                        <td><%= dm.estado.status %></td>
                                        <td><%= dm.corretora.nome %></td>
                                        <td><%= dm.deriva_tipo.tipo %></td>
                                        <td><%= dm.quantidade %></td>
                                        <td style="width: 145px;">
                                            <span class="text-primary"><%= number_to_currency(resultado_aberta(dm), unit: "R$ ", separator: ",", delimiter: ".", strip_insignificant_zeros: true) %></span>
                                            <span class="text-primary"><%= number_to_currency(resultado_po(dm), unit: "R$ ", separator: ",", delimiter: ".", strip_insignificant_zeros: true) %></span>
                                            <span class="text-primary"><% if dm.strike.present? %><%= number_to_currency(resultado_exercicio(dm), unit: "R$ ", separator: ",", delimiter: ".", strip_insignificant_zeros: true) %><% end %></span>
                                            <span class="text-<%= cor_resultado_recompra(dm) %>"><%= number_to_currency(resultado_recompra(dm), unit: "R$ ", separator: ",", delimiter: ".", strip_insignificant_zeros: true) %></span>
                                            
                                        </td>
                                        <td><%= link_to 'Edit', edit_deriva_move_path(dm) %></td>
                                        <td><%= link_to 'Destroy', dm, method: :delete, data: { confirm: 'Are you sure?' } %></td>
                                        
                                      </tr>
                                    <% end %>
                                  </tbody>
                            </table>
                        </div>
                   </div>
                   
            </div>
            <% end %>
        <% end %>
    </div>
</div>

            <!--<div id="accordion">-->
            <!--   <div class="card card-default mb-1">-->
            <!--      <div class="card-header" id="headingOne">-->
            <!--         <h4 class="mb-0">-->
            <!--             <a class="text-inherit" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" href="">-->
            <!--             Collapsible Group Item #1-->
            <!--             </a>-->
            <!--             </h4>-->
            <!--      </div>-->
            <!--      <div class="collapse show" id="collapseOne" aria-labelledby="headingOne" data-parent="#accordion" style="">-->
            <!--         <div class="card-body border-top">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.</div>-->
            <!--      </div>-->
            <!--   </div>-->
            <!--   <div class="card card-default mb-1">-->
            <!--      <div class="card-header" id="headingTwo">-->
            <!--         <h4 class="mb-0"><a class="text-inherit collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" href="">Collapsible Group Item #2</a></h4>-->
            <!--      </div>-->
            <!--      <div class="collapse" id="collapseTwo" aria-labelledby="headingTwo" data-parent="#accordion">-->
            <!--         <div class="card-body border-top">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.</div>-->
            <!--      </div>-->
            <!--   </div>-->
            <!--   <div class="card card-default mb-1">-->
            <!--      <div class="card-header" id="headingThree">-->
            <!--         <h4 class="mb-0"><a class="text-inherit collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree" href="">Collapsible Group Item #3</a></h4>-->
            <!--      </div>-->
            <!--      <div class="collapse" id="collapseThree" aria-labelledby="headingThree" data-parent="#accordion">-->
            <!--         <div class="card-body border-top">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.</div>-->
            <!--      </div>-->
            <!--   </div>-->
            <!--</div>-->


