<%= form_tag deriva_moves_path, method: :get, enforce_utf8: false do %>
    <div class="row">
        <div class="col-md-2 mt-4 mb-4">
            <%= select_tag :por_carteira, options_for_select(Carteira.all.collect {|t| [t.nome, t.id]}, selected: params[:por_carteira]), prompt: 'Carteira', class: 'form-control' %>
        </div>
        <div class="col-md-2 mt-4 mb-4">
            <%= select_tag :por_estado, options_for_select(Estado.all.collect {|t| [t.status, t.id]}, selected: params[:por_estado]), prompt: 'Estado', class: 'form-control' %>
        </div>
        <div class="col-md-2 mt-4 mb-4">
            <%= select_tag :por_corretora, options_for_select(Corretora.all.collect {|t| [t.nome, t.id]}, selected: params[:por_corretora]), prompt: 'Corretora', class: 'form-control' %>
        </div>
        <div class="col-md-2 mt-4 mb-4">
            <%= select_tag :por_derivativo, options_for_select(Derivativo.all.collect {|t| [t.codigo, t.id]}, selected: params[:por_derivativo]), prompt: 'Derivativo', class: 'form-control' %>
        </div>
        <!--Como colocar mais informações no options_for_select-->
        <div class="col-md-2 mt-4 mb-4">
            <%= select_tag :por_investimento, options_for_select(Investimento.all.collect {|t| [t.ativo.ticker, t.id]}, selected: params[:por_investimento]), prompt: 'Investimento', class: 'form-control' %>
        </div>
        <div class="col-md-2 mt-4 mb-4">
            <%= submit_tag 'Filtrar', class: 'btn btn-default', name: nil %>
        </div>
    </div>
<% end %> 
<div class="float-right"><%= link_to new_deriva_move_path do %>
	<button class="btn btn-outline-success">
		<em class="fa fa-plus-circle"></em> &nbsp; Nova movimentação (Derivativos)
	</button><% end %>
</div>
<h3 class="h3-custom" id="minhas-paginas">
	<em class="fa fa-usd text-success"></em> &nbsp; Movimentação dos derivativos
</h3>
<div class="table-responsive">
	<table class="table table-striped table-bordered table-hover">
          <thead>
            <tr>
              <th>Invest id</th>
              <th>Derivativo</th>
              <th>Status</th>
              <th>Vencimento</th>
              <th>Premio</th>
              <th>Quant</th>
              <th>Result View</th>
              <th>Result db</th>
              <th colspan="2"></th>
            </tr>
          </thead>
        
          <tbody>
            <% @deriva_moves.each do |dm| %>
            <tr>
                <td>
                    <%= dm.investimento.carteira.nome %>  <%= dm.investimento.corretora.nome %>  <%= dm.investimento.ativo.ticker %> </br>
                    <!--Tem que ser igual a de cima com a de baixo-->
                    <%= dm.carteira.nome %>  <%= dm.corretora.nome %>  <%= dm.derivativo.ativo.ticker %>
                </td>
                <td><%= dm.derivativo.codigo %></td>
                <td><%= dm.estado.status %></td>
                <td><%= dm.derivativo.vencimento.data.strftime("%d/%m/%Y") %></td>
                <td>R$ <%= number_with_precision(dm.valor, :precision => 2) %></td>
                <td><%= dm.quantidade %></td>
                <!--resultado_especificos está no aplication helper-->
                <td>
                    <span class="text-primary"><%= resultado_aberta(dm) %></span>
                    <span class="text-primary"><%= resultado_po(dm) %></span>
                    <span class="text-primary"><%= resultado_exercicio(dm) %></span>
                    <span class="text-<%= cor_resultado_recompra(dm) %>"><%= resultado_recompra(dm) %></span>
                    
                </td>
                <td><%= dm.resultado %></td>
                <td><%= link_to 'Edit', edit_deriva_move_path(dm) %></td>
                <td><%= link_to 'Destroy', dm, method: :delete, data: { confirm: 'Are you sure?' } %></td>
              </tr>
            <% end %>
          </tbody>
    </table>
</div>

